"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4457],{11550:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var i=r(86106),a=r(82036);const t={id:"examples-custom-bridge",title:"Custom bridge & validator"},s=void 0,o={id:"examples-custom-bridge",title:"Custom bridge & validator",description:"In this example, we will create an ordinary login form, with login, password, and password confirmation fields.",source:"@site/versioned_docs/version-3.0/examples-custom-bridge.md",sourceDirName:".",slug:"/examples-custom-bridge",permalink:"/docs/3.0/examples-custom-bridge",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{id:"examples-custom-bridge",title:"Custom bridge & validator"},sidebar:"docs",previous:{title:"Custom fields",permalink:"/docs/3.0/examples-custom-fields"},next:{title:"Custom form",permalink:"/docs/3.0/examples-custom-form"}},d={},l=[{value:"Schema definition",id:"schema-definition",level:3},{value:"Validator definition",id:"validator-definition",level:3},{value:"The Bridge!",id:"the-bridge",level:3},{value:"Usage",id:"usage",level:3}];function c(e){const n={a:"a",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"In this example, we will create an ordinary login form, with login, password, and password confirmation fields."}),"\n",(0,i.jsx)(n.h3,{id:"schema-definition",children:"Schema definition"}),"\n",(0,i.jsx)(n.p,{children:"We'll start with defining a schema.\nIt's an object with three keys, representing our fields.\nEach of them has the following self-explanatory properties:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"__type__"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"required"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"initialValue"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"label"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const UserLoginSchema = {\n  login: {\n    __type__: String,\n    required: true,\n    initialValue: '',\n    label: 'Login',\n  },\n  password1: {\n    __type__: String,\n    required: true,\n    initialValue: '',\n    label: 'Password',\n  },\n  password2: {\n    __type__: String,\n    required: true,\n    initialValue: '',\n    label: 'Password (again)',\n  },\n};\n\nexport default UserLoginSchema;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"validator-definition",children:"Validator definition"}),"\n",(0,i.jsx)(n.p,{children:"When the schema is ready, our next step is to provide a way to check if the values received from our form are correct.\nIn order to do so, we prepare a validation function.\nThat function, called validator, takes a model (the submitted object) as input and throws an error whether any value doesn't meet given criteria."}),"\n",(0,i.jsx)(n.p,{children:"In our case we say 'form is invalid' when there's no login or password at all,\nlogin has less then 5 characters, password has lass then 10 characters or given passwords mismatch:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const UserLoginSchemaValidator = model => {\n  const error = {};\n\n  if (!model.login) {\n    error.login = 'Login is required!';\n  } else if (model.login.length < 5) {\n    error.login = 'Login has to be at least 5 characters long!';\n  }\n\n  if (!model.password1) {\n    error.password1 = 'Password is required!';\n  } else if (model.password1.length < 10) {\n    error.login = 'Password has to be at least 10 characters long!';\n  }\n\n  if (model.password1 !== model.password2) {\n    error.password1 = 'Passwords mismatch!';\n  }\n\n  if (Object.keys(error).length) {\n    return error;\n  }\n};\n\nexport default UserLoginSchemaValidator;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"the-bridge",children:"The Bridge!"}),"\n",(0,i.jsxs)(n.p,{children:["Now that both have the schema and the validator, we can define our bridge, which will be a binder between the form and the data itself.\nAll we have to do is to extend ",(0,i.jsx)(n.code,{children:"Bridge"})," class and implement its methods according to the ",(0,i.jsx)(n.a,{href:"/docs/3.0/uth-bridge-concept",children:"Bridge concept"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"import { Bridge } from 'uniforms';\n\nexport default class UserLoginSchemaBridge extends Bridge {\n  constructor(schema, validator) {\n    super();\n\n    this.schema = schema;\n    this.validator = validator;\n  }\n\n  getError(name, error) {\n    return error && error[name];\n  }\n\n  getErrorMessage(name, error) {\n    return (error && error[name]) || '';\n  }\n\n  getErrorMessages(error) {\n    return error ? Object.keys(this.schema).map(field => error[field]) : [];\n  }\n\n  getField(name) {\n    return this.schema[name.replace(/\\.\\d+/g, '.$')];\n  }\n\n  getType(name) {\n    return this.schema[name.replace(/\\.\\d+/g, '.$')].__type__;\n  }\n\n  getProps(name) {\n    return this.schema[name.replace(/\\.\\d+/g, '.$')];\n  }\n\n  getInitialValue(name) {\n    return this.schema[name.replace(/\\.\\d+/g, '.$')].initialValue;\n  }\n\n  getSubfields(name) {\n    return name\n      ? this.schema[name.replace(/\\.\\d+/g, '.$')].subfields || []\n      : Object.keys(this.schema).filter(field => field.indexOf('.') === -1);\n  }\n\n  getValidator() {\n    return this.validator;\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.p,{children:"After our custom bridge is created, we can use in the very same way as we would use predefined one -\nwe have to supply the schema and validator and then we can take an advantage of it in the AutoForm:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"import UserLoginSchema from './UserLoginSchema';\nimport UserLoginSchemaBridge from './UserLoginSchemaBridge';\nimport UserLoginSchemaValidator from './UserLoginSchemaValidator';\n\nconst bridge = new UserLoginSchemaBridge(\n  UserLoginSchema,\n  UserLoginSchemaValidator,\n);\n\n<AutoForm schema={bridge} />;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},82036:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>o});var i=r(7378);const a={},t=i.createContext(a);function s(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);